refactor part id assignment post wrap