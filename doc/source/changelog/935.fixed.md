fix cap types and cap type check